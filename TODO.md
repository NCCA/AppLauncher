1. Add popup item to json so prompts can be displayed after run for installers
2. add optional command line for json
3. re-factor and tidy up code.